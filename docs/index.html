<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Really, Really, Ridiculously Fast Tweet Data • tweetio</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Really, Really, Ridiculously Fast Tweet Data">
<meta property="og:description" content="
    `{tweetio}`'s goal is to go from raw tweets to `{rtweet}`-style data frames 
    as fast as possible, whether or not the data came from the Twitter API, a 
    database dump, or some other library.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-140885143-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-140885143-4');
</script>
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tweetio</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/knapply_">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/knapply/tweetio">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="tweetio" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tweetio" class="anchor"></a><code>{tweetio}</code>
</h1></div>
<!-- badges: start -->

</div>
<div id="progress" class="section level1">
<h1 class="hasAnchor">
<a href="#progress" class="anchor"></a>Progress</h1>
<div id="supported-data-inputs" class="section level3">
<h3 class="hasAnchor">
<a href="#supported-data-inputs" class="anchor"></a>Supported Data Inputs</h3>
<ul>
<li>
<input type="checkbox" disabled checked>
Twitter API streams: .json, .json.gz</li>
<li>
<input type="checkbox" disabled checked>
API to Elasticsearch data dump (JSON Array): .json, .json.gz</li>
<li>
<input type="checkbox" disabled checked>
API to Elasticsearch data dump (line-delimited JSON): .jsonl, .jsonl.gz</li>
<li>
<input type="checkbox" disabled checked>
CSV (if written via <code><a href="reference/write_tweet_csv.html">tweetio::write_tweet_csv()</a></code>)</li>
</ul>
</div>
<div id="supported-data-outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#supported-data-outputs" class="anchor"></a>Supported Data Outputs</h3>
<ul>
<li>
<input type="checkbox" disabled checked>
CSV</li>
<li>
<input type="checkbox" disabled checked>
Excel</li>
<li>
<input type="checkbox" disabled>
.graphml (currently available in <a href="https://knapply.github.io/tweetgraph/"><code>{tweetgraph}</code></a>)</li>
</ul>
</div>
<div id="extras" class="section level3">
<h3 class="hasAnchor">
<a href="#extras" class="anchor"></a>Extras</h3>
<ul>
<li>
<input type="checkbox" disabled checked>
Spatial Tweets via <code><a href="reference/as_tweet_sf.html">tweetio::as_tweet_sf()</a></code>
</li>
</ul>
</div>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>{tweetio}</code> (mainly) focuses on one thing: <strong>going from raw tweets to <code>{rtweet}</code>-style data frames and other useful structures) as quickly as possible</strong>. Whether the data came from the Twitter API, a database dump, or some other source, <code>{tweetio}</code>’s job is to get them into R.</p>
<p><code>{tweetio}</code> is <strong>not</strong> a competitor to <code>{rtweet}</code>; it is not interested in collecting Twitter data. That said, it definitely attempts to emulate its data frame schema because…</p>
<ol>
<li>It’s incredibly easy to use.</li>
<li>It’s more efficient to analyze than a key-value format following the raw data.</li>
<li>It’d be a waste not to maximize compatibiltiy with tools built specifically around <code>{rtweet}</code>’s data frames.</li>
</ol>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>You’ll need a C++ compiler. If you’re using Windows, you’ll need <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a>.</p>
<p>You probably want to follow the page’s advice and select the recommended version, which is currently Rtools35.exe. When you’re installing Rtools, you need to make sure you check the box stating “Add rtools to system PATH” and reboot when you’re finished.</p>
<p>Once you’re done, reboot. Then you can install <code>{tweetio}</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages("remotes")</span></a>
<a class="sourceLine" id="cb1-2" title="2">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"knapply/tweetio"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level1">
<h1 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h1>
<div id="simple-example" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-example" class="anchor"></a>Simple Example</h2>
<p>First, we’ll save a stream of tweets using <code><a href="https://rdrr.io/pkg/rtweet/man/stream_tweets.html">rtweet::stream_tweets()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">temp_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>(<span class="dt">fileext =</span> <span class="st">".json"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/stream_tweets.html">stream_tweets</a></span>(<span class="dt">timeout =</span> <span class="dv">15</span>, <span class="dt">parse =</span> <span class="ot">FALSE</span>, <span class="dt">file_name =</span> temp_file)</a></code></pre></div>
<p>We can then pass the file path to <code><a href="reference/read_tweets.html">tweetio::read_tweets()</a></code> to efficiently parse the data into an <code>{rtweet}</code>-style data frame.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tweetio)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">small_rtweet_stream &lt;-<span class="st"> </span><span class="kw"><a href="reference/read_tweets.html">read_tweets</a></span>(temp_file)</a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5">tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(small_rtweet_stream)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co">#&gt; # A tibble: 599 x 90</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt;    user_id status_id created_at          screen_name text  source reply_to_status~ reply_to_user_id</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt;  1 954058~ 11962617~ 2019-11-18 03:00:11 bmuukt_     &lt;U+0E41&gt;&lt;U+0E21&gt;&lt;U+0E48&gt;&lt;U+0E08&gt;~  Twitt~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt;  2 252410~ 11962617~ 2019-11-18 03:00:11 Biancaraaa  Imbi~ Twitt~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt;  3 282568~ 11962617~ 2019-11-18 03:00:11 loran_moon  &lt;U+4ECA&gt;&lt;U+65E5&gt;&lt;U+306E&gt;&lt;U+663C&gt;~ twitt~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt;  4 917758~ 11962617~ 2019-11-18 03:00:11 _galaxy18   RT @~ Twitt~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt;  5 108389~ 11962617~ 2019-11-18 03:00:11 kiiroimaim~ @min~ Twitt~ 119626158955013~ 962592071126155~</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt;  6 105991~ 11962617~ 2019-11-18 03:00:11 gilloidbot  "\"(~ twitt~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt;  7 481937~ 11962617~ 2019-11-18 03:00:11 otoma100HP  &lt;U+3057&gt;&lt;U+3087&gt;&lt;U+3063&gt;&lt;U+3061&gt;~ Tweet~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt;  8 984574~ 11962617~ 2019-11-18 03:00:11 zirah__     RT @~ Twitt~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;  9 119295~ 11962617~ 2019-11-18 03:00:11 NomNomKu    @edc~ Twitt~ 119621290997140~ 777931862       </span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; 10 107273~ 11962617~ 2019-11-18 03:00:11 jyxdefsoul  &lt;U+0E2D&gt;&lt;U+0E48&gt;&lt;U+0E30&gt; ~  Twitt~ &lt;NA&gt;             &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; # ... with 589 more rows, and 82 more variables: reply_to_screen_name &lt;chr&gt;, is_quote &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; #   is_retweet &lt;lgl&gt;, hashtags &lt;list&gt;, urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;,</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt; #   media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, mentions_user_id &lt;list&gt;,</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt; #   mentions_screen_name &lt;list&gt;, quoted_status_id &lt;chr&gt;, quoted_text &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; #   quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;, quoted_favorite_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; #   quoted_retweet_count &lt;int&gt;, quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;, quoted_statuses_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt; #   quoted_location &lt;chr&gt;, quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt; #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;, retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt; #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;, retweet_user_id &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt; #   retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;, retweet_followers_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt; #   retweet_friends_count &lt;int&gt;, retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt; #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;, place_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt; #   place_full_name &lt;chr&gt;, place_type &lt;chr&gt;, country &lt;chr&gt;, country_code &lt;chr&gt;, bbox_coords &lt;list&gt;,</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt; #   status_url &lt;chr&gt;, name &lt;chr&gt;, location &lt;chr&gt;, description &lt;chr&gt;, url &lt;chr&gt;, protected &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt; #   followers_count &lt;int&gt;, friends_count &lt;int&gt;, listed_count &lt;int&gt;, statuses_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">#&gt; #   favourites_count &lt;int&gt;, account_created_at &lt;dttm&gt;, verified &lt;lgl&gt;, profile_url &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">#&gt; #   account_lang &lt;chr&gt;, profile_banner_url &lt;chr&gt;, profile_image_url &lt;chr&gt;, is_retweeted &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb4-32" title="32"><span class="co">#&gt; #   retweet_place_url &lt;chr&gt;, retweet_place_name &lt;chr&gt;, retweet_place_full_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-33" title="33"><span class="co">#&gt; #   retweet_place_type &lt;chr&gt;, retweet_country &lt;chr&gt;, retweet_country_code &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-34" title="34"><span class="co">#&gt; #   retweet_bbox_coords &lt;list&gt;, quoted_place_url &lt;chr&gt;, quoted_place_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-35" title="35"><span class="co">#&gt; #   quoted_place_full_name &lt;chr&gt;, quoted_place_type &lt;chr&gt;, quoted_country &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb4-36" title="36"><span class="co">#&gt; #   quoted_country_code &lt;chr&gt;, quoted_bbox_coords &lt;list&gt;, timestamp_ms &lt;dttm&gt;,</span></a>
<a class="sourceLine" id="cb4-37" title="37"><span class="co">#&gt; #   contributors_enabled &lt;lgl&gt;, profile_url2 &lt;chr&gt;</span></a></code></pre></div>
</div>
<div id="scaling-up" class="section level2">
<h2 class="hasAnchor">
<a href="#scaling-up" class="anchor"></a>Scaling Up</h2>
<p>We’re more interested in handling much larger data sets, but for demonstration we’ll use a file of a reasonable size that was obtained using <code><a href="https://rdrr.io/pkg/rtweet/man/stream_tweets.html">rtweet::stream_tweets()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">rtweet_stream_path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"example-data/api-stream.json.gz"</span>, <span class="dt">package =</span> <span class="st">"tweetio"</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3">scales<span class="op">::</span><span class="kw"><a href="https://scales.r-lib.org//reference/number_bytes_format.html">number_bytes</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.info.html">file.size</a></span>(rtweet_stream_path))</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">#&gt; [1] "18 Mb"</span></a></code></pre></div>
<p>Before compression, the file was about 153 Mb.</p>
<p>Unfortunately, <code><a href="https://rdrr.io/pkg/rtweet/man/parse_stream.html">rtweet::parse_stream()</a></code> may fail parsing streams because the data returned may not be valid JSON.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/parse_stream.html">parse_stream</a></span>(rtweet_stream_path)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">#&gt; Error: parse error: after array element, I expect ',' or ']'</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt;           736405012481"},"timestamp_ms":"1569693801061"}}{"created_at"</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt;                      (right here) ------^</span></a></code></pre></div>
<p>The only way around this is to read the entire file into memory and run some validation routine before parsing, which looks something like this…</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">rtweet_validate_and_parse &lt;-<span class="st"> </span><span class="cf">function</span>(source_file_path, target_file_path) {</a>
<a class="sourceLine" id="cb9-2" title="2">  raw_lines &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(source_file_path)</a>
<a class="sourceLine" id="cb9-3" title="3">  valid_lines &lt;-<span class="st"> </span>raw_lines[<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span>(raw_lines, jsonify<span class="op">::</span>validate_json, <span class="kw"><a href="https://rdrr.io/r/base/logical.html">logical</a></span>(1L))]</a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="kw"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span>(valid_lines, target_file_path)</a>
<a class="sourceLine" id="cb9-5" title="5">  </a>
<a class="sourceLine" id="cb9-6" title="6">  rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/parse_stream.html">parse_stream</a></span>(target_file_path)</a>
<a class="sourceLine" id="cb9-7" title="7">}</a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9">rtweet_stream_path2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>(<span class="dt">fileext =</span> <span class="st">".json"</span>)</a>
<a class="sourceLine" id="cb9-10" title="10"></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="kw">rtweet_validate_and_parse</span>(<span class="dt">source_file_path =</span> rtweet_stream_path, </a>
<a class="sourceLine" id="cb9-12" title="12">                          <span class="dt">target_file_path =</span> rtweet_stream_path2)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">#&gt; # A tibble: 12,824 x 90</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt;    user_id status_id created_at          screen_name text  source display_text_wi~ reply_to_status~</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt;  1 807195~ 11780078~ 2019-09-28 18:05:23 ykaoi0327   "&lt;U+4EE5&gt;&lt;U+4E0A&gt;&lt;U+3067&gt;~ Twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt;  2 114393~ 11780078~ 2019-09-28 18:05:23 yowasugi723 "@Di~ Twitt~                9 117771450591824~</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt;  3 247059~ 11780078~ 2019-09-28 18:05:23 itsauroras~ "“So~ Twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt;  4 822602~ 11780078~ 2019-09-28 18:05:23 Darrell894~ It's~ Twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt;  5 797200~ 11780078~ 2019-09-28 18:05:23 NastyWoman~ @Bra~ Twitt~               69 117796816033668~</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;  6 110779~ 11780078~ 2019-09-28 18:05:23 DeshaunAwe~ met ~ twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt;  7 110441~ 11780078~ 2019-09-28 18:05:23 diamondy_u  "&lt;U+2728&gt;Lo~ Twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt;  8 359294~ 11780078~ 2019-09-28 18:05:23 piyakat28   "Saf~ Twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt;  9 194250~ 11780078~ 2019-09-28 18:05:23 Stgo_centro Me d~ Twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt; 10 116013~ 11780078~ 2019-09-28 18:05:23 119lonwi_y~ &lt;U+D55C&gt;&lt;U+AD6D&gt;&lt;U+C5D0&gt;&lt;U+C11C&gt;~ Twitt~               NA &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; # ... with 12,814 more rows, and 82 more variables: reply_to_user_id &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt; #   reply_to_screen_name &lt;chr&gt;, is_quote &lt;lgl&gt;, is_retweet &lt;lgl&gt;, favorite_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt; #   retweet_count &lt;int&gt;, quote_count &lt;int&gt;, reply_count &lt;int&gt;, hashtags &lt;list&gt;, symbols &lt;list&gt;,</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; #   urls_url &lt;list&gt;, urls_t.co &lt;list&gt;, urls_expanded_url &lt;list&gt;, media_url &lt;list&gt;,</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; #   media_t.co &lt;list&gt;, media_expanded_url &lt;list&gt;, media_type &lt;list&gt;, ext_media_url &lt;list&gt;,</span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="co">#&gt; #   ext_media_t.co &lt;list&gt;, ext_media_expanded_url &lt;list&gt;, ext_media_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-20" title="20"><span class="co">#&gt; #   mentions_user_id &lt;list&gt;, mentions_screen_name &lt;list&gt;, lang &lt;chr&gt;, quoted_status_id &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-21" title="21"><span class="co">#&gt; #   quoted_text &lt;chr&gt;, quoted_created_at &lt;dttm&gt;, quoted_source &lt;chr&gt;, quoted_favorite_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co">#&gt; #   quoted_retweet_count &lt;int&gt;, quoted_user_id &lt;chr&gt;, quoted_screen_name &lt;chr&gt;, quoted_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-23" title="23"><span class="co">#&gt; #   quoted_followers_count &lt;int&gt;, quoted_friends_count &lt;int&gt;, quoted_statuses_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb10-24" title="24"><span class="co">#&gt; #   quoted_location &lt;chr&gt;, quoted_description &lt;chr&gt;, quoted_verified &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb10-25" title="25"><span class="co">#&gt; #   retweet_status_id &lt;chr&gt;, retweet_text &lt;chr&gt;, retweet_created_at &lt;dttm&gt;, retweet_source &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-26" title="26"><span class="co">#&gt; #   retweet_favorite_count &lt;int&gt;, retweet_retweet_count &lt;int&gt;, retweet_user_id &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-27" title="27"><span class="co">#&gt; #   retweet_screen_name &lt;chr&gt;, retweet_name &lt;chr&gt;, retweet_followers_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb10-28" title="28"><span class="co">#&gt; #   retweet_friends_count &lt;int&gt;, retweet_statuses_count &lt;int&gt;, retweet_location &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-29" title="29"><span class="co">#&gt; #   retweet_description &lt;chr&gt;, retweet_verified &lt;lgl&gt;, place_url &lt;chr&gt;, place_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-30" title="30"><span class="co">#&gt; #   place_full_name &lt;chr&gt;, place_type &lt;chr&gt;, country &lt;chr&gt;, country_code &lt;chr&gt;, geo_coords &lt;list&gt;,</span></a>
<a class="sourceLine" id="cb10-31" title="31"><span class="co">#&gt; #   coords_coords &lt;list&gt;, bbox_coords &lt;list&gt;, status_url &lt;chr&gt;, name &lt;chr&gt;, location &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb10-32" title="32"><span class="co">#&gt; #   description &lt;chr&gt;, url &lt;chr&gt;, protected &lt;lgl&gt;, followers_count &lt;int&gt;, friends_count &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb10-33" title="33"><span class="co">#&gt; #   listed_count &lt;int&gt;, statuses_count &lt;int&gt;, favourites_count &lt;int&gt;, account_created_at &lt;dttm&gt;,</span></a>
<a class="sourceLine" id="cb10-34" title="34"><span class="co">#&gt; #   verified &lt;lgl&gt;, profile_url &lt;chr&gt;, profile_expanded_url &lt;chr&gt;, account_lang &lt;lgl&gt;,</span></a>
<a class="sourceLine" id="cb10-35" title="35"><span class="co">#&gt; #   profile_banner_url &lt;chr&gt;, profile_background_url &lt;chr&gt;, profile_image_url &lt;chr&gt;</span></a></code></pre></div>
<p>Fortunately, <code>{tweetio}</code> can handle these situations by validating the JSON before it gets anywhere near R.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">bench<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bench/man/mark.html">mark</a></span>(</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw"><a href="reference/read_tweets.html">read_tweets</a></span>(rtweet_stream_path),</a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="dt">min_iterations =</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb11-4" title="4">)[, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>]</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">#&gt; # A tibble: 1 x 6</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt;   expression                           min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt;   &lt;bch:expr&gt;                      &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#&gt; 1 read_tweets(rtweet_stream_path)    5.18s    5.31s     0.189     220MB    0.818</span></a></code></pre></div>
<p>Ignoring the time it takes to run the above <code>rtweet_validate_and_parse()</code> function for <code><a href="https://rdrr.io/pkg/rtweet/man/parse_stream.html">rtweet::parse_stream()</a></code> to work, how much faster is <code><a href="reference/read_tweets.html">tweetio::read_tweets()</a></code>?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">bench_mark &lt;-<span class="st"> </span>bench<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bench/man/mark.html">mark</a></span>(</a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">rtweet =</span> rtweet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rtweet/man/parse_stream.html">parse_stream</a></span>(rtweet_stream_path2),</a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="dt">tweetio =</span> tweetio<span class="op">::</span><span class="kw"><a href="https://knapply.github.io/tweetio/reference/read_tweets.html">read_tweets</a></span>(rtweet_stream_path2),</a>
<a class="sourceLine" id="cb13-4" title="4">  <span class="dt">check =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb13-5" title="5">  <span class="dt">min_iterations =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb13-6" title="6">  <span class="dt">filter_gc =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb13-7" title="7">)</a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9">bench_mark[, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>]</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co">#&gt; # A tibble: 2 x 6</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">#&gt; 1 rtweet       26.61s   28.15s    0.0359     476MB    4.96 </span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">#&gt; 2 tweetio       4.43s    5.53s    0.193      174MB    0.644</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(bench_mark)</a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-9-1.png" style="display: block; margin: auto;"></p>
<p>With bigger files, using <code><a href="https://rdrr.io/pkg/rtweet/man/parse_stream.html">rtweet::parse_stream()</a></code> is no longer realistic, but that’s where <code><a href="reference/read_tweets.html">tweetio::read_tweets()</a></code> can help.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">big_tweet_stream_path &lt;-<span class="st"> "~/ufc-tweet-stream.json.gz"</span></a>
<a class="sourceLine" id="cb16-2" title="2">scales<span class="op">::</span><span class="kw"><a href="https://scales.r-lib.org//reference/number_bytes_format.html">number_bytes</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/file.info.html">file.size</a></span>(big_tweet_stream_path)) <span class="co"># 1.2 Gb before compression</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">#&gt; [1] "122 Mb"</span></a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">bench<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/bench/man/mark.html">mark</a></span>(</a>
<a class="sourceLine" id="cb18-2" title="2">  big_tweet_df &lt;-<span class="st"> </span>tweetio<span class="op">::</span><span class="kw"><a href="https://knapply.github.io/tweetio/reference/read_tweets.html">read_tweets</a></span>(big_tweet_stream_path)</a>
<a class="sourceLine" id="cb18-3" title="3">)[, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>]</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co">#&gt; # A tibble: 1 x 6</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#&gt;   expression                                                    min median `itr/sec` mem_alloc</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">#&gt;   &lt;bch:expr&gt;                                                  &lt;bch&gt; &lt;bch:&gt;     &lt;dbl&gt; &lt;bch:byt&gt;</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">#&gt; 1 big_tweet_df &lt;- tweetio::read_tweets(big_tweet_stream_path) 37.9s  37.9s    0.0264     863MB</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">#&gt; # ... with 1 more variable: `gc/sec` &lt;dbl&gt;</span></a></code></pre></div>
<!-- ## Data Dumps -->
<!-- Using Elasticsearch seems to be the most common practice for handling social media data at scale, but it's (unfortunately) possible that you'll need to work with data dumps. -->
<!-- The data collected from APIs are stored inside a nested JSON object named `"doc"`. `"doc"` is typically embedded in a ton of system metadata, most of which you probably don't care about.  -->
<!-- I've encountered two flavors of these schema: -->
<!-- 1. .jsonl: newline-delimited JSON -->
<!-- 2. .json: the complete contents of a database dump packed in a JSON array -->
<!-- The .jsonl structure looks something like this: -->
<!-- ```{r, eval=FALSE, echo=FALSE} -->
<!-- es_jsonl <- readLines("inst/example-data/elasticsearch-dump-example.jsonl") -->
<!-- cat(paste0(es_jsonl, collapse = "\n")) -->
<!-- ``` -->
<!-- ```json -->
<!-- {"system_metadata_you_dont_care_about":"blahblahblah","more_metadata1":"blahblahblah","more_metadata2":"blahblahblah","more_metadata3":"blahblahblah","more_metadata4":"blahblahblah","more_metadata5":"blahblahblah","doc":{"text":"********************HERE'S THE DATA YOU ACTUALLY WANT********************","id":92108498098018010401,"id_str":"92108498098018010401"},"more_metadata6":"blahblahblah","more_metadata7":"blahblahblah","more_metadata8":"blahblahblah","more_metadata9":"blahblahblah","more_metadata10":"blahblahblah"} -->
<!-- {"system_metadata_you_dont_care_about":"blahblahblah","more_metadata1":"blahblahblah","more_metadata2":"blahblahblah","more_metadata3":"blahblahblah","more_metadata4":"blahblahblah","more_metadata5":"blahblahblah","doc":{"text":"********************HERE'S THE DATA YOU ACTUALLY WANT********************","id":92108498098018010401,"id_str":"92108498098018010401"},"more_metadata6":"blahblahblah","more_metadata7":"blahblahblah","more_metadata8":"blahblahblah","more_metadata9":"blahblahblah","more_metadata10":"blahblahblah"} -->
<!-- {"system_metadata_you_dont_care_about":"blahblahblah","more_metadata1":"blahblahblah","more_metadata2":"blahblahblah","more_metadata3":"blahblahblah","more_metadata4":"blahblahblah","more_metadata5":"blahblahblah","doc":{"text":"********************HERE'S THE DATA YOU ACTUALLY WANT********************","id":92108498098018010401,"id_str":"92108498098018010401"},"more_metadata6":"blahblahblah","more_metadata7":"blahblahblah","more_metadata8":"blahblahblah","more_metadata9":"blahblahblah","more_metadata10":"blahblahblah"} -->
<!-- ``` -->
<!-- Each line contains a single JSON object resembling the following: -->
<!-- ```{r, echo=FALSE, eval=FALSE} -->
<!-- jsonlite::prettify(es_jsonl[[1]]) -->
<!-- ``` -->
<!-- ```json -->
<!-- { -->
<!--     "system_metadata_you_dont_care_about": "blahblahblah", -->
<!--     "more_metadata1": "blahblahblah", -->
<!--     "more_metadata2": "blahblahblah", -->
<!--     "more_metadata3": "blahblahblah", -->
<!--     "more_metadata4": "blahblahblah", -->
<!--     "more_metadata5": "blahblahblah", -->
<!--     "doc": { -->
<!--         "text": "********************HERE'S THE DATA YOU ACTUALLY WANT********************", -->
<!--         "id": 92108498098018010401, -->
<!--         "id_str": "92108498098018010401" -->
<!--     }, -->
<!--     "more_metadata6": "blahblahblah", -->
<!--     "more_metadata7": "blahblahblah", -->
<!--     "more_metadata8": "blahblahblah", -->
<!--     "more_metadata9": "blahblahblah", -->
<!--     "more_metadata10": "blahblahblah" -->
<!-- } -->
<!-- ``` -->
<!-- And the .json structure looks something like this: -->
<!-- ```{r, echo=FALSE, eval=FALSE} -->
<!-- es_json <- readr::read_file("inst/example-data/elasticsearch-dump-example.json") -->
<!-- jsonlite::prettify(es_json) -->
<!-- ``` -->
<!-- ```json -->
<!-- [ -->
<!--     { -->
<!--         "_id": "e5daf1467d2438e31b11b44a82cbd7f5758ba5a1f1d3ecbcc6e1fc04dc9c7c4d-3016858092318", -->
<!--         "_index": "org-77f135f331153568ab7eb0e4c24623a7-default-3769a33b9e88598e38317591e2ee31c3-default-030009", -->
<!--         "_score": null, -->
<!--         "_source": { -->
<!--             "system_metadata_you_dont_care_about": "blahblahblah", -->
<!--             "more_metadata1": "blahblahblah", -->
<!--             "doc": { -->
<!--                 "text": "********************HERE'S THE DATA YOU ACTUALLY WANT********************", -->
<!--                 "id": 92108498098018010401, -->
<!--                 "id_str": "92108498098018010401" -->
<!--             }, -->
<!--             "more_metadata6": "blahblahblah" -->
<!--         } -->
<!--     }, -->
<!--     { -->
<!--         "_id": "e5daf1467d2438e31b11b44a82cbd7f5758ba5a1f1d3ecbcc6e1fc04dc9c7c4d-3016858092318", -->
<!--         "_index": "org-77f135f331153568ab7eb0e4c24623a7-default-3769a33b9e88598e38317591e2ee31c3-default-030009", -->
<!--         "_score": null, -->
<!--         "_source": { -->
<!--             "system_metadata_you_dont_care_about": "blahblahblah", -->
<!--             "more_metadata1": "blahblahblah", -->
<!--             "doc": { -->
<!--                 "text": "********************HERE'S THE DATA YOU ACTUALLY WANT********************", -->
<!--                 "id": 92108498098018010401, -->
<!--                 "id_str": "92108498098018010401" -->
<!--             }, -->
<!--             "more_metadata6": "blahblahblah" -->
<!--         } -->
<!--     } -->
<!-- ] -->
<!-- ``` -->
<!-- This has three unfortunate consequences: -->
<!-- 1. Packages that were purpose-built to work directly with `{rtweet}`'s data frames can't play along with your data. -->
<!-- 2. You're going to waste most of your time (and memory) getting data into R that you're not going to use. -->
<!-- 3. The data are _very_ tedious to restructure in R (lists of lists of lists of lists of lists...). -->
<!-- `{tweetio}` solves this by parsing everything and building the data frames at the C++ level. -->
</div>
</div>
<div id="spatial-tweets" class="section level1">
<h1 class="hasAnchor">
<a href="#spatial-tweets" class="anchor"></a>Spatial Tweets</h1>
<p>Tweet JSON contains an object called <code>"place"</code> that is set aside for location information. If present, it looks something like the following.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb20-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb20-2" title="2">    <span class="dt">"text"</span><span class="fu">:</span> <span class="st">"#rstats4lyfe"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-3" title="3">    <span class="dt">"place"</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb20-4" title="4">      <span class="dt">"id"</span><span class="fu">:</span> <span class="st">"00d546b224a6764d"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-5" title="5">      <span class="dt">"url"</span><span class="fu">:</span> <span class="st">"https://api.twitter.com/1.1/geo/id/blahblah.json"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-6" title="6">      <span class="dt">"place_type"</span><span class="fu">:</span> <span class="st">"city"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-7" title="7">      <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"General Pico"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-8" title="8">      <span class="dt">"full_name"</span><span class="fu">:</span> <span class="st">"General Pico, Argentina"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-9" title="9">      <span class="dt">"country_code"</span><span class="fu">:</span> <span class="st">"AR"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-10" title="10">      <span class="dt">"country"</span><span class="fu">:</span> <span class="st">"Argentina"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-11" title="11">      <span class="dt">"bounding_box"</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb20-12" title="12">          <span class="dt">"type"</span><span class="fu">:</span> <span class="st">"Polygon"</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb20-13" title="13">          <span class="dt">"coordinates"</span><span class="fu">:</span> <span class="ot">[</span></a>
<a class="sourceLine" id="cb20-14" title="14">              <span class="ot">[</span></a>
<a class="sourceLine" id="cb20-15" title="15">                  <span class="ot">[</span></a>
<a class="sourceLine" id="cb20-16" title="16">                      <span class="fl">-63.784544</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb20-17" title="17">                      <span class="fl">-35.689402</span></a>
<a class="sourceLine" id="cb20-18" title="18">                  <span class="ot">],</span></a>
<a class="sourceLine" id="cb20-19" title="19">                  <span class="ot">[</span></a>
<a class="sourceLine" id="cb20-20" title="20">                      <span class="fl">-63.784544</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb20-21" title="21">                      <span class="fl">-35.641737</span></a>
<a class="sourceLine" id="cb20-22" title="22">                  <span class="ot">],</span></a>
<a class="sourceLine" id="cb20-23" title="23">                  <span class="ot">[</span></a>
<a class="sourceLine" id="cb20-24" title="24">                      <span class="fl">-63.724717</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb20-25" title="25">                      <span class="fl">-35.641737</span></a>
<a class="sourceLine" id="cb20-26" title="26">                  <span class="ot">],</span></a>
<a class="sourceLine" id="cb20-27" title="27">                  <span class="ot">[</span></a>
<a class="sourceLine" id="cb20-28" title="28">                      <span class="fl">-63.724717</span><span class="ot">,</span></a>
<a class="sourceLine" id="cb20-29" title="29">                      <span class="fl">-35.689402</span></a>
<a class="sourceLine" id="cb20-30" title="30">                  <span class="ot">]</span></a>
<a class="sourceLine" id="cb20-31" title="31">              <span class="ot">]</span></a>
<a class="sourceLine" id="cb20-32" title="32">          <span class="ot">]</span></a>
<a class="sourceLine" id="cb20-33" title="33">      <span class="fu">},</span></a>
<a class="sourceLine" id="cb20-34" title="34">      <span class="dt">"attributes"</span><span class="fu">:</span> <span class="fu">{}</span></a>
<a class="sourceLine" id="cb20-35" title="35">    <span class="fu">}</span></a>
<a class="sourceLine" id="cb20-36" title="36"><span class="fu">}</span></a></code></pre></div>
<p>In <code>{rtweet}</code>-style data frames, this corresponds to the <code>bbox_coords</code> column.</p>
<p>If you have <code>{sf}</code> installed, you can use <code><a href="reference/as_tweet_sf.html">as_tweet_sf()</a></code> to filter the tweets for those that contain valid coordinates and build their bounding box polygons.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">tweet_sf &lt;-<span class="st"> </span><span class="kw"><a href="reference/as_tweet_sf.html">as_tweet_sf</a></span>(<span class="dt">tweet_df =</span> big_tweet_df) </a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3">tweet_sf[, <span class="st">"bbox_coords"</span>]</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co">#&gt; Simple feature collection with 2215 features and 0 fields</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">#&gt; geometry type:  POLYGON</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#&gt; dimension:      XY</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">#&gt; bbox:           xmin: -179.2311 ymin: -50.35726 xmax: 179.8597 ymax: 71.43436</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co">#&gt; epsg (SRID):    4326</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">#&gt; proj4string:    +proj=longlat +datum=WGS84 +no_defs</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="co">#&gt; First 10 features:</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">#&gt;                       bbox_coords</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co">#&gt; 1  POLYGON ((-90.23761 29.9683...</span></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="co">#&gt; 2  POLYGON ((-80.20811 26.0809...</span></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">#&gt; 3  POLYGON ((17.08005 59.73069...</span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co">#&gt; 4  POLYGON ((-80.51985 39.7198...</span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="co">#&gt; 5  POLYGON ((-80.34364 25.5991...</span></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="co">#&gt; 6  POLYGON ((-118.6684 33.7045...</span></a>
<a class="sourceLine" id="cb22-15" title="15"><span class="co">#&gt; 7  POLYGON ((-122.0662 37.9242...</span></a>
<a class="sourceLine" id="cb22-16" title="16"><span class="co">#&gt; 8  POLYGON ((-118.4485 33.9768...</span></a>
<a class="sourceLine" id="cb22-17" title="17"><span class="co">#&gt; 9  POLYGON ((-97.66262 27.5785...</span></a>
<a class="sourceLine" id="cb22-18" title="18"><span class="co">#&gt; 10 POLYGON ((-118.6684 33.7045...</span></a></code></pre></div>
<p>There are currently three columns that can potentially hold bounding boxes:</p>
<ol>
<li><code>bbox_coords</code></li>
<li><code>quoted_bbox_coords</code></li>
<li><code>retweet_bbox_coords</code></li>
</ol>
<p>You can select which one to use to build your <code>sf</code> object by modifying the <code>geom_col=</code> parameter (default: <code>"bbox_coords"</code>)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="reference/as_tweet_sf.html">as_tweet_sf</a></span>(big_tweet_df, <span class="dt">geom_col =</span> <span class="st">"quoted_bbox_coords"</span></a>
<a class="sourceLine" id="cb23-2" title="2">            )[, <span class="st">"quoted_bbox_coords"</span>]</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co">#&gt; Simple feature collection with 1254 features and 0 fields</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co">#&gt; geometry type:  POLYGON</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co">#&gt; dimension:      XY</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="co">#&gt; bbox:           xmin: -124.849 ymin: -27.76744 xmax: 153.3179 ymax: 60.29791</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co">#&gt; epsg (SRID):    4326</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co">#&gt; proj4string:    +proj=longlat +datum=WGS84 +no_defs</span></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co">#&gt; First 10 features:</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="co">#&gt;                quoted_bbox_coords</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="co">#&gt; 1  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="co">#&gt; 2  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-11" title="11"><span class="co">#&gt; 3  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co">#&gt; 4  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-13" title="13"><span class="co">#&gt; 5  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-14" title="14"><span class="co">#&gt; 6  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-15" title="15"><span class="co">#&gt; 7  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="co">#&gt; 8  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-17" title="17"><span class="co">#&gt; 9  POLYGON ((-73.99354 40.7507...</span></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="co">#&gt; 10 POLYGON ((-73.99354 40.7507...</span></a></code></pre></div>
<p>You can also build <em>all</em> the supported bounding boxes by setting <code>geom_col=</code> to <code>"all"</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">all_bboxes &lt;-<span class="st"> </span><span class="kw"><a href="reference/as_tweet_sf.html">as_tweet_sf</a></span>(big_tweet_df, <span class="dt">geom_col =</span> <span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb25-2" title="2">all_bboxes[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"geometry"</span>, <span class="st">"which_geom"</span>)]</a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co">#&gt; Simple feature collection with 7441 features and 1 field</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co">#&gt; geometry type:  POLYGON</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">#&gt; dimension:      XY</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">#&gt; bbox:           xmin: -179.2311 ymin: -50.35726 xmax: 179.8597 ymax: 71.43436</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co">#&gt; epsg (SRID):    4326</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">#&gt; proj4string:    +proj=longlat +datum=WGS84 +no_defs</span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co">#&gt; First 10 features:</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">#&gt;                          geometry  which_geom</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co">#&gt; 1  POLYGON ((-90.23761 29.9683... bbox_coords</span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="co">#&gt; 2  POLYGON ((-80.20811 26.0809... bbox_coords</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="co">#&gt; 3  POLYGON ((17.08005 59.73069... bbox_coords</span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="co">#&gt; 4  POLYGON ((-80.51985 39.7198... bbox_coords</span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="co">#&gt; 5  POLYGON ((-80.34364 25.5991... bbox_coords</span></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co">#&gt; 6  POLYGON ((-118.6684 33.7045... bbox_coords</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co">#&gt; 7  POLYGON ((-122.0662 37.9242... bbox_coords</span></a>
<a class="sourceLine" id="cb26-16" title="16"><span class="co">#&gt; 8  POLYGON ((-118.4485 33.9768... bbox_coords</span></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="co">#&gt; 9  POLYGON ((-97.66262 27.5785... bbox_coords</span></a>
<a class="sourceLine" id="cb26-18" title="18"><span class="co">#&gt; 10 POLYGON ((-118.6684 33.7045... bbox_coords</span></a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(all_bboxes<span class="op">$</span>which_geom)</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode R"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co">#&gt; [1] "bbox_coords"         "quoted_bbox_coords"  "retweet_bbox_coords"</span></a></code></pre></div>
<p>From there, you can easily use the data like any other <code>{sf}</code> object.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb29-2" title="2"></a>
<a class="sourceLine" id="cb29-3" title="3">world &lt;-<span class="st"> </span>rnaturalearth<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/rnaturalearth/man/ne_countries.html">ne_countries</a></span>(<span class="dt">returnclass =</span> <span class="st">"sf"</span>)</a>
<a class="sourceLine" id="cb29-4" title="4">world &lt;-<span class="st"> </span>world[world<span class="op">$</span>continent <span class="op">!=</span><span class="st"> "Antarctica"</span>, ]</a>
<a class="sourceLine" id="cb29-5" title="5"></a>
<a class="sourceLine" id="cb29-6" title="6">sf_for_gg &lt;-<span class="st"> </span>sf<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/sf/man/st_transform.html">st_wrap_dateline</a></span>(all_bboxes)</a>
<a class="sourceLine" id="cb29-7" title="7"></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="kw">ggplot</span>(sf_for_gg) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">fill =</span> <span class="st">"white"</span>, <span class="dt">color =</span> <span class="st">"lightgray"</span>, <span class="dt">data =</span> world) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> which_geom, <span class="dt">color =</span> which_geom), <span class="dt">alpha =</span> <span class="fl">0.15</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">show.legend =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-11" title="11"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">3857</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-12" title="12"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-13" title="13"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(), <span class="dt">legend.position =</span> <span class="st">"top"</span>,</a>
<a class="sourceLine" id="cb29-15" title="15">        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"#daf3ff"</span>))</a></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-14-1.png" style="display: block; margin: auto;"></p>
</div>
<div id="can-we-go-faster" class="section level1">
<h1 class="hasAnchor">
<a href="#can-we-go-faster" class="anchor"></a>Can we go faster?</h1>
<p>Until Rtools 4.0 hits (or the <a href="https://github.com/lemire/simdjson"><code>simdjson</code></a> library decides to <a href="https://github.com/lemire/simdjson/issues/307">relax its C++17 requirement</a>), I’m not sure how we can go much faster while maintaining cross-platform compatibility. That said, contibutions are welcome, especially if C++ is your mother tongue.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p><code>{tweetio}</code> uses a combination of C++ via <a href="http://www.rcpp.org/"><code>{Rcpp}</code></a>, the <a href="http://rapidjson.org/"><code>rapidjson</code></a> C++ library (made available by <a href="https://cran.r-project.org/web/packages/rapidjsonr/index.html"><code>{rapidjsonr}</code></a>), <a href="https://cran.r-project.org/web/packages/jsonify/index.html"><code>{jsonify}</code></a>) for an R-level interface to <code>rapidjson</code>, <a href="https://cran.r-project.org/web/packages/RcppProgress/index.html"><code>{RcppProgress}</code></a>), and <strong>R’s secret weapon</strong>: <a href="https://rdatatable.gitlab.io/data.table/"><code>{data.table}</code></a>.</p>
<p>Major inspiration from <a href="https://gitlab.com/hrbrmstr/ndjson">{<code>ndjson</code>}</a> was taken, particularly its use of <a href="https://www.cs.unc.edu/Research/compgeom/gzstream/"><code>Gzstream</code></a>.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/knapply/tweetio">https://​github.com/​knapply/​tweetio</a>
</li>
<li>Report a bug at <br><a href="https://github.com/knapply/tweetio/issues">https://​github.com/​knapply/​tweetio/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing tweetio</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Brendan Knapp <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3284-4972" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=tweetio"><img src="https://www.r-pkg.org/badges/version/tweetio" alt="CRAN status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle"></a></li>
<li><a href="https://github.com/knapply/tweetio/commits/master"><img src="https://img.shields.io/github/last-commit/knapply/tweetio.svg" alt="GitHub last commit"></a></li>
<li><a href="https://codecov.io/gh/knapply/tweetio?branch=master"><img src="https://codecov.io/gh/knapply/tweetio/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://ci.appveyor.com/project/knapply/tweetio"><img src="https://ci.appveyor.com/api/projects/status/github/knapply/tweetio?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://travis-ci.org/knapply/tweetio"><img src="https://travis-ci.org/knapply/tweetio.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></li>
<li><a href="https://www.r-project.org/"><img src="https://img.shields.io/badge/Depends-GNU_R%3E=3.3-blue.svg" alt="Depends"></a></li>
<li><a href="https://github.com/knapply/tweetio"><img src="https://img.shields.io/github/languages/code-size/knapply/tweetio.svg" alt="GitHub code size in bytes"></a></li>
<li><a href="http://hits.dwyl.io/knapply/tweetio"><img src="http://hits.dwyl.io/knapply/tweetio.svg" alt="HitCount"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Brendan Knapp.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
